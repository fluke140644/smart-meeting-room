{% load static %}

<!DOCTYPE html>
<html lang="th">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏≠‡∏á‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.datatables.net/1.13.4/css/jquery.dataTables.min.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.4/js/jquery.dataTables.min.js"></script>



    <style>
        .sidebar-transition {
            transition: all 0.3s;
        }

        #sidebar {
            transform: translateX(-100%);
        }

        #sidebar.active {
            transform: translateX(0);
        }

        /* Content move when sidebar active */
        .content-transition {
            transition: all 0.3s;
        }

        .content-move {
            margin-left: 16rem;
            /* ‡∏Å‡∏ß‡πâ‡∏≤‡∏á‡πÄ‡∏ó‡πà‡∏≤ sidebar 64 = 16rem */
        }

        /*.background-color: #f5f5f5;
      font-family: 'Tahoma', sans-serif;
    }*/
        .content-container {
            padding: 20px;
            background-color: white;
            margin-top: 20px;
            border-radius: 8px;
        }

        .search-bar {
            margin-bottom: 20px;
        }

        .status-btn {
            width: 60px;
        }

        .table> :not(caption)>*>* {
            vertical-align: middle;
        }

        .table-title {
            margin-bottom: 24px;
            /* ‡∏´‡∏£‡∏∑‡∏≠ 2rem, ‡πÅ‡∏•‡πâ‡∏ß‡πÅ‡∏ï‡πà‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£ */
        }

        /* ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠ */
        body {
            font-family: 'Sarabun', sans-serif;
            margin: 16px;
            animation: gradientBG 15s infinite alternate;
            background: linear-gradient(-45deg, #4FC3F7, #81C784, #F1F8E9, #607D8B, #F1F8E9);
            background-size: 400% 400%;
        }


        @keyframes gradientBG {
            0% {
                background-position: 0% 50%;
            }

            50% {
                background-position: 80% 50%;
            }

            100% {
                background-position: 0% 50%;
            }
        }
    </style>
</head>

<body class="bg-gray-100">

    <!-- Navbar -->
    <nav
        class="fixed top-0 left-0 right-0 h-16 bg-gradient-to-r from-green-500 to-blue-500 text-white flex justify-between items-center px-4 shadow z-50">
        <div class="flex items-center space-x-2">
            <!-- Hamburger -->
            <button onclick="toggleSidebar()" class="text-3xl text-white mr-2">&#9776;</button>
            <!-- Logo & Title -->
            <a href="/home"><img src="https://sdh.go.th/img/sdh.jpg" class="w-10 h-10 rounded-full" alt="logo"></a>
            <span class="text-xl font-bold">‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏≠‡∏á‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°</span>
        </div>
    </nav>

    <!-- Sidebar -->
    <aside id="sidebar"
        class="fixed top-16 left-0 w-64 h-[calc(100%-4rem)] bg-gray-800 text-white p-4 z-40 flex flex-col justify-between">
        <div>
            {% if user.is_authenticated %}
            <!-- User Info -->
            <div class="flex items-center space-x-3 mb-6 bg-gray-700 p-3 rounded">
                <div class="w-10 h-10 bg-white rounded-full flex items-center justify-center text-gray-800 text-xl">üë§
                </div>
                <div>
                    <div class="font-semibold">‡∏ä‡∏∑‡πà‡∏≠: {{ user.get_full_name|default:user.username }}</div>
                    <div class="text-sm text-gray-300">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: {{ user.is_staff|yesno:"admin,user" }}</div>
                </div>
            </div>
            {% endif %}

            <!-- ‡πÄ‡∏°‡∏ô‡∏π -->
            <div class="flex justify-between items-center mb-6">
                <h1 class="text-xl font-bold">‡πÄ‡∏°‡∏ô‡∏π</h1>
                <button onclick="toggleSidebar()" class="text-white text-3xl">&times;</button>
            </div>
            <ul class="space-y-2">
                <li><a href="/home" class="block hover:text-yellow-400 bg-gray-700 p-2 rounded">üè† Home</a></li>
                <li><a href="/about"
                        class="block hover:text-yellow-400 bg-gray-700 p-2 rounded">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°</a></li>
                <li><a href="/RoomBooking" class="block hover:text-yellow-400 bg-gray-700 p-2 rounded">‡∏à‡∏≠‡∏á‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°</a>
                </li>
            </ul>
        </div>

        <!-- Logout -->
        <div>
            <form method="post" action="{% url 'logout' %}" class="mt-6">
                {% csrf_token %}
                <button type="submit" class="w-full hover:text-yellow-400 bg-gray-700 p-2 rounded">üö™
                    ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</button>
            </form>
            <hr class="border-gray-600 my-2">
            <h4 class="text-sm text-gray-400 text-right">Version 0.0.1</h4>
        </div>
    </aside>


    <hr class="border-gray-500 mb-4">


    <!-- Content -->
<div class="w-full px-2">
    <div id="main-content" class="flex flex-wrap gap-4 mt-4 justify-center content-transition">
  
      <div class="pt-20 w-full max-w-screen-lg">
        <div class="content-container w-full">
  
          <!-- ‡∏õ‡∏∏‡πà‡∏°‡∏à‡∏≠‡∏á‡∏´‡πâ‡∏≠‡∏á -->
          <div class="d-flex justify-content-end mb-2">
            <a href="{% url 'book_room' %}" class="btn btn-success">‡∏à‡∏≠‡∏á‡∏´‡πâ‡∏≠‡∏á</a>
          </div>
  
          <!-- ‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ -->
          <form method="get" class="grid grid-cols-1 md:grid-cols-5 gap-2 mb-4">
            <div>
              <label>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏´‡πâ‡∏´‡πâ‡∏≠‡∏á</label>
              <input type="date" class="form-control" name="start_date" value="{{ request.GET.start_date }}">
            </div>
            <div>
              <label>‡∏ñ‡∏∂‡∏á</label>
              <input type="date" class="form-control" name="end_date" value="{{ request.GET.end_date }}">
            </div>
            <div>
              <label>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</label>
              <select class="form-select" name="status">
                <option value="">===‡∏ó‡∏∏‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞===</option>
                <option value="approved" {% if selected_status == "approved" %}selected{% endif %}>‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥</option>
                <option value="pending" {% if selected_status == "pending" %}selected{% endif %}>‡∏£‡∏≠‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥</option>
                <option value="cancelled" {% if selected_status == "cancelled" %}selected{% endif %}>‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</option>
              </select>
            </div>
            <div>
              <label>‡∏Ñ‡∏≥‡∏Ñ‡πâ‡∏ô</label>
              <input type="text" class="form-control" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏´‡πâ‡∏≠‡∏á, ‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡πÉ‡∏ö‡∏à‡∏≠‡∏á" name="q"
                value="{{ request.GET.q }}">
            </div>
            <div class="flex items-end">
              <button type="submit" class="btn btn-primary w-full">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</button>
            </div>
          </form>
  
          <h5 class="mb-3"><strong>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏´‡πâ‡∏≠‡∏á</strong></h5>
  
          <!-- ‡∏ï‡∏≤‡∏£‡∏≤‡∏á -->
          <div class="overflow-x-auto">
            <table id="booking-table" class="table table-bordered w-full text-sm md:text-base">
              <thead class="table-light">
                <tr>
                  <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                  <th>‡∏£‡∏´‡∏±‡∏™‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á</th>
                  <th>‡∏ß‡∏±‡∏ô/‡πÄ‡∏ß‡∏•‡∏≤</th>
                  <th>‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏° / ‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠</th>
                  <th>‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</th>
                </tr>
              </thead>
              <tbody>
                {% for booking in bookings %}
                <tr>
                  <td class="align-middle text-center">
                    {% if booking.status == "approved" %}
                    <span class="badge bg-success">‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥</span>
                    {% elif booking.status == "pending" %}
                    <span class="badge bg-warning text-dark">‡∏£‡∏≠‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥</span>
                    {% elif booking.status == "cancelled" %}
                    <span class="badge bg-danger">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</span>
                    {% endif %}
                  </td>
                  <td class="text-center align-middle">{{ booking.booking_code }}</td>
                  <td class="text-center align-middle">
                    {{ booking.start_datetime|date:"d M Y H:i" }}<br>
                    ‡∏ñ‡∏∂‡∏á {{ booking.end_datetime|date:"d M Y H:i" }}
                  </td>
                  <td class="text-center align-middle">
                    <strong>‡∏ä‡∏∑‡πà‡∏≠‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏° : {{ booking.room_name }}</strong><br>
                    ‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠ : {{ booking.topic }}
                  </td>
                  <td class="text-center align-middle">
                    <a href="{% url 'booking_detail' booking.id %}" class="btn btn-sm btn-info">‡πÅ‡∏™‡∏î‡∏á</a>
                  </td>
                </tr>
                {% empty %}
                <tr>
                  <td colspan="5" class="text-center">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á</td>
                </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>
  


    <script>
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const content = document.getElementById('main-content');

            sidebar.classList.toggle('active');
            content.classList.toggle('content-move');
        }

        $(document).ready(function () {
            $('#booking-table').DataTable({
                "pageLength": 5,
                "lengthMenu": [[5, 10, 15, 20, -1], [5, 10, 15, 20, "‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î"]],
                "searching": false,
                "order": [[1, 'desc']],
                "language": {
                    "lengthMenu": "‡πÅ‡∏™‡∏î‡∏á _MENU_ ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ï‡πà‡∏≠‡∏´‡∏ô‡πâ‡∏≤",
                    "zeroRecords": "‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•",
                    "info": "‡πÅ‡∏™‡∏î‡∏á‡∏´‡∏ô‡πâ‡∏≤ _PAGE_ ‡∏à‡∏≤‡∏Å _PAGES_",
                    "infoEmpty": "‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡πÅ‡∏™‡∏î‡∏á",
                    "infoFiltered": "(‡∏Å‡∏£‡∏≠‡∏á‡∏à‡∏≤‡∏Å‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î _MAX_ ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£)",
                    // "search": "‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤:",
                    "paginate": {
                        "first": "‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å",
                        "last": "‡∏´‡∏ô‡πâ‡∏≤‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢",
                        "next": "‡∏ñ‡∏±‡∏î‡πÑ‡∏õ",
                        "previous": "‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤"
                    }
                }
            });
        });

    </script>


</body>

</html>